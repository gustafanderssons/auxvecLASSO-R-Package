% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_outcome.R
\name{fit_outcome}
\alias{fit_outcome}
\title{Fit LASSO model for a single binary outcome with cross-validation}
\usage{
fit_outcome(
  yvar,
  df,
  X,
  penalty_factors,
  nfolds = 5,
  standardize = TRUE,
  parallel = FALSE,
  return_models = FALSE,
  verbose = FALSE
)
}
\arguments{
\item{yvar}{Character scalar. The name of the binary outcome variable in \code{df}.}

\item{df}{Data frame containing the outcome and predictors.
The outcome variable (\code{yvar}) and predictor variables must be included in \code{df}.}

\item{X}{Model matrix (rows must align with \code{df}).
The matrix must not contain missing values, and its rows must match those in \code{df}.}

\item{penalty_factors}{Named numeric vector of penalty factors for each predictor variable.
The names should match the column names of \code{X}.}

\item{nfolds}{Number of folds for cross-validation. Default is 5.}

\item{standardize}{Logical; should the predictors be standardized before fitting the model? Default is \code{TRUE}.}

\item{parallel}{Logical; should the cross-validation be performed in parallel? Default is \code{FALSE}.}

\item{return_models}{Logical; should the fitted \code{cv.glmnet} object be returned? Default is \code{FALSE}.}

\item{verbose}{Logical; if \code{TRUE}, prints progress messages. Default is \code{FALSE}.}
}
\value{
A list containing:
\describe{
\item{selected}{A character vector of the names of the selected variables (non-zero coefficients).}
\item{lambda_min}{The value of \code{lambda} that minimizes the cross-validation error.}
\item{goodness}{A list containing performance metrics for the model:
\itemize{
\item \code{cross_validated}: A list with \code{cv_error} (cross-validation error) and \code{cv_error_sd} (standard deviation of CV error).
\item \code{full_data}: A list with:
\item \code{deviance_explained}: Proportion of deviance explained by the model.
\item \code{auc}: Area under the ROC curve.
\item \code{accuracy}: Classification accuracy.
\item \code{brier_score}: Brier score (mean squared error for probabilities).
\item \code{raw_coefs}: Raw coefficients from the LASSO model.
\item \code{abs_coefs}: Absolute values of the coefficients.
}
}
\item{model}{The fitted \code{cv.glmnet} model, if \code{return_models = TRUE}. Otherwise, \code{NULL}.}
}
}
\description{
Fits a LASSO logistic regression model for a single binary outcome using cross-validation.
The function drops rows where the outcome is missing, and ensures that the predictors do not
have missing values. The model is fitted using the \code{glmnet} package, with the option to apply
cross-validation for selecting the optimal regularization parameter (\code{lambda}).
}
\details{
\itemize{
\item The outcome variable (\code{yvar}) must be binary (two levels) after dropping missing values.
\item Rows with missing values for the outcome (\code{yvar}) or predictors (\code{X}) will be dropped.
\item The function uses the \code{glmnet} package to fit the LASSO logistic regression model.
\item Cross-validation is used to select the optimal regularization parameter (\code{lambda}).
\item Model performance metrics, including AUC, accuracy, and Brier score, are computed on the non-missing rows.
}
}
